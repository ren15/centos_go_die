name: centos_dev

on:
  push:
    paths:
      - '.github/workflows/centos_dev.yml'

env:
  DEBIAN_FRONTEND: noninteractive

jobs:
  build:
    runs-on: ubuntu-20.04
    container:
      image: centos:7
    steps:
      - name: System basic setup
        run: |
          yum update -y && yum install -y curl openssl-devel git

      - name: Compile and install git
        run: |
          yum install -y dh-autoreconf curl-devel expat-devel gettext-devel \
            openssl-devel perl-devel zlib-devel make 
          git clone --depth 1 https://github.com/git/git.git
          cd git
          make configure
          ./configure --prefix=/usr
          make install

      - name: Setup brew
        run: |
          /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
          echo 'eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"' >> /github/home/.profile
          eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"

      - name: Use brew
        run: |
          eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
          brew install gcc-10

